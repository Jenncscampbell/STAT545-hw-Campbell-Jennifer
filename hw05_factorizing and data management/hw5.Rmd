---
title: "Homework 5"
output: github_document
---


```{r, echo=FALSE, warning=FALSE, message=FALSE}
library(gapminder)
library(singer)
library(tidyverse)
library(knitr)
library(ggthemes)
library(reshape2)
library(dplyr)
library(ggplot2)
library(forcats)
```

I decided to work with the singer dataset for a change :smile:

## Factor Management

**Factorize.** Transform some of the variable in the `singer_locations` dataframe into factors: pay attention at what levels you introduce and their order. Try and consider the difference between the base R `as.factor` and the `forcats`-provided functions.

First I just want to inspect the data: 
```{r}
data("singer_locations")
kable(head(singer_locations))
```

First I tried to factorize city with the but that didn't work. This seems to be due to the existance of NA values. (Here I presented the code as a block quote since knitr wont render a file with code errors.)

> sl_fac <-singer_locations %>% 
  mutate(city_factor = as_factor(city))

>Output: Error in mutate_impl(.data, dots) : Evaluation error: `idx` must contain one integer for each level of `f`.

Remove NA's and then run: 

```{r}
singer_locations %>% 
  filter(!is.na(city)) %>% 
  mutate(city_factor = as_factor(city)) 
kable(head(singer_locations %>% 
  filter(!is.na(city)) %>% 
  mutate(city_factor = as_factor(city)) ))
```


Before deciding to remove NA's I'll just use `forcats` since we probably don't want to be reordering our factor anyway. 
```{r}
sl_fac <- singer_locations %>% 
  mutate(city_factor = factor(city))
kable(head(sl_fac))
```

**Drop 0.** Filter the `singer_locations` data to remove observations associated with the uncorrectly inputed `year` 0. Additionally, remove unused factor levels. Provide concrete information on the data before and after removing these rows and levels; address the number of rows and the levels of the affected factors.

First I removed any data with the year 0: 
Prior to removal there were 10100 observations 

```{r}
str(sl_fac)
```
 But after there were only 1000 observations
```{r}
filter(sl_fac, year != "0") %>% 
    str(sl_fac)
```


Then I removed any unused factor levels-  NA values for `city_factor`.
```{r}
sl_fac %>% 
    filter(!is.na(city)) %>% 
  str(sl_fac)
```

Now there are only 4129 observations but with 1316 factor levels for city_factor. 

In examining the data though there are a few odd factors like "?, Illinois, 020, 27, 310 Lousiana, 732 New Jersey" I decided to remove these as well. 

```{r}
sl_new <- (sl_fac %>% 
filter( city_factor != "?, Illinois")  %>% 
  filter( city_factor != "020") %>% 
  filter( city_factor != "310, Louisiana") %>% 
  filter( city_factor != "732, NEW JERSEY, USA") %>% 
  filter( city_factor != "27")) 
    str(sl_new) 
```

The structure now indicates that there are only 4122 observations. However, it does still list ?, Illinois. Just to check I tried to call up one of the removed items. 
```{r}
sl_new %>% 
filter(city_factor == "?, Illinois") 
```

It did indead remove the value but I guess it still remembers it as a factor that did exist at one point. 

**Reorder the levels of `year`, `artist_name` or `title`.** Use the forcats package to change the order of the factor levels, based on a principled summary of one of the quantitative variables. Consider experimenting with a summary statistic beyond the most basic choice of the median.
