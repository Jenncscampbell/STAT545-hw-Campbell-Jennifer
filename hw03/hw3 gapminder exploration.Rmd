---
title: "HW 3 Gapminder Exploration"
output: github_document
---

```{r, echo=FALSE, warning=FALSE, message=FALSE}
library(gapminder)
library(tidyverse)
library(knitr)
library(ggthemes)
library(reshape2)
```



## Task 1: Get the maximum and minimum of GDP per capita for all continents:
First I created a basic table with each continents's maximum and minimum GDP per capita:
```{r, echo=FALSE, warning=FALSE, message=FALSE}
kable(gapminder %>% 
    group_by(continent) %>% 
    summarize(Max_gdpPercap=max(gdpPercap),Min_gdpPercap=min(gdpPercap)))
```

Then I created a new dataframe object with just the data I was interested in.
```{r, echo=FALSE, warning=FALSE, message=FALSE}
mygdp<-
gapminder %>% 
  group_by(continent) %>% 
  summarize(Max_gdpPercap=max(gdpPercap),Min_gdpPercap=min(gdpPercap))
```

```{r, echo=FALSE, warning=FALSE, message=FALSE}
mygdp
```

This table seems to show that Asia has the largest maximum GDP per capita and that Africa has the lowest. In terms of the minimum GDP per capita, Africa has the lowest while Oceania has the highest.

Since I want r to cluster my max and min gdp per capitals, I need to put these into a single variable which r can then graph by colour. To do this I used the `melt` function.

```{r, echo=FALSE, warning=FALSE, message=FALSE}
gdp <- melt(mygdp[,c('continent','Max_gdpPercap','Min_gdpPercap')],id.vars = 1)
ggplot(gdp,aes(x = continent,y = value)) + 
  geom_bar(aes(fill = variable),stat = "identity",position = "dodge") 
```

This layout is still a bit tricky to read because of the large differences in gdp. So I put the y-axis on a log scale of 10 before cleaning up the graph.

```{r, echo=FALSE, warning=FALSE, message=FALSE}
p1<-ggplot(gdp,aes(x = continent,y = value)) + 
  geom_bar(aes(fill = variable),stat = "identity",position = "dodge") +
  scale_fill_discrete("GDP Per Capita Levels")  + 
  scale_y_log10() 
p1 + labs(x="Conintents", 
          y="GDP Per Capita",
          title="Maximum and Minimum GDP per capita")
```
```

In this graph we can see the maximum and minimum GDP per capita levels clearly for each continent. Overall, Asia appears to have the largest difference between the maximum and minimum GDP per capita in the records. However, Asia also has the highest maximum GDP per capita in the records. We can also see that Oceania has the smallest difference between its maximum and minimum GDP per capita levels. The highest minimum GDP per capita level belongs to Oceania while the lowest belongs to Africa. 

## Task 2: Look at the spread of GDP per capita within the continents.

```{r, echo=FALSE, warning=FALSE, message=FALSE}
kable(gapminder %>% 
group_by(continent) %>% 
summarize(Mean=mean(gdpPercap),Min=min(gdpPercap), Max=max(gdpPercap), StdDev=sd(gdpPercap), Q25=quantile(gdpPercap, probs=.25), Q50=quantile(gdpPercap, probs=.5), Q75=quantile(gdpPercap, probs=.75)))
```


This table is really hard to read. There is a lot of information. We can see that Europe and Oceania have higher means than the other continent but China has a much higher maximum than the rest. 

The best way I think to plot data distributions like this is with box plots:

```{r, echo=FALSE, warning=FALSE, message=FALSE}
gapminder %>%
  ggplot(aes(x=continent, y=gdpPercap)) +
  geom_boxplot(alpha=0.25, size=1, shape=1)  +
  labs(title = "GPD Per Capita") 
```


This is still very hard to read so I decided to have plot the log10 of the y-axis. 

```{r, echo=FALSE, warning=FALSE, message=FALSE}
gapminder %>%
  ggplot(aes(x=continent, y=gdpPercap)) +
  geom_boxplot(alpha=0.25, size=1, shape=1)  +
  labs(x="Continents", y="GDP Per Capita", title = "GPD Per Capita") +
  scale_y_log10() 
```

This graph is much easier to read. Here we can easily compare the means and tell that Oceania and Europe have higher overall GDP per capita than Africa and Asia. However, the distribution is much more spread out for Asia than any of the other continents with Oceania showing little variation in GDP per capita than the other continents. We can also see that the maximum values are higher for Asia than the other continents. 

### Task 3: Compute a weighted mean of life expectancy for different years. Here life expectancy is weighted by GDP per Capita.

```{r}

```

